# 《Smart QC Tools 控制图模块》使用手册
**（软件著作权申请建议参考文档版本）**

---

## 1. 软件概述

### 1.1 软件名称及版本
**软件名称**：Smart QC Tools 工业级质量控制软件  
**版本号**：V1.0  
**功能模块**：统计过程控制 (SPC) - 控制图模块

### 1.2 开发背景与用途
控制图（Control Chart）是 SPC 统计过程控制的核心工具，用于区分过程中的“偶然波动”与“异常波动”。本模块针对工业现场数据采集碎片化、判异规则执行不统一等痛点，开发了基于 **Canvas 高清渲染引擎** 的动态控制图。支持 I-MR、X-bar-R 等多种经典计量型控制图，并内置了完备的 **Nelson/Western Electric 判异规则引擎**，能够实时自动识别制程失控状态，为生产质量预警提供决策支持。

---

## 2. 软件运行环境

### 2.1 硬件环境
- **处理器**：双核 2.4GHz 或更高
- **内存**：8GB 以上（推荐，用于流畅处理大规模数据实时计算）
- **显示器**：分辨率 1920x1080 (1080P) 及以上，以获得最佳统计曲线细节展示

### 2.2 软件环境
- **操作系统**：Windows 10/11, macOS, Linux (通用 Web 架构)
- **渲染技术**：HTML5 Canvas 2D 高速渲染引擎
- **浏览器**：Chrome 100+, Edge, Safari (建议开启硬件加速)

---

## 3. 核心功能及操作规程

### 3.1 模块界面入口
点击系统主导航“Control Chart”进入。界面沿用平台标准 Workspace 架构：
- **左侧配置区**：提供手动录入、DSL 脚本编辑及 AI 逻辑推理。
- **中间绘图区**：渲染高清动态 Canvas 控制图。
- **底部工具栏**：提供布局整理与工业级文件导出。

---

### 3.2 数据录入与 DSL 语法规范 (DSL & Data Input)
**功能描述**：采用结构化 DSL 描述控制图属性，支持多值批量导入。

**操作规程**：
1. **序列定义**：使用 `[series]: [序列名称]` 开始，以 `[/series]` 结束。
2. **多值录入**：支持在一行内通过逗号 `,`、空格或分号分隔多个观测值。
   - *示例*：`12.5, 12.8, 12.1` 代表一个样本时间点的三个观测值或连续三个单点。
3. **属性配置指令**：
   - `Title: [标题]`：设置图表名称。
   - `Type: [I-MR/X-bar-R]`：切换控制图类型。
   - `Size: [N]`：定义子组样本容量（Subgroup Size）。
   - `Decimals: [N]`：控制小数点计算精度。
   - `Rules: [Nelson/Western-Electric]`：定义启用的判异规则包。

---

### 3.3 判异规则引擎操作 (Anomaly Detection Rules)
**功能描述**：内置工业级自动侦测逻辑，点位异常时自动高亮提示（红点标记）。

**配置流程**：
1. 在配置面板中点击相应的规则按钮（如 **Nelson** 或 **Western-Electric**）。
2. **规则明细说明**：
   - **Rule 1 (超出限值)**：点落在 UCL 或 LCL 之外。
   - **Rule 2 (中心偏移)**：连续 9 个点落在中心线同一侧。
   - **Rule 3 (趋势漂移)**：连续 6 个点持续上升或下降。
   - **Rule 4 (周期波动)**：连续 14 个点交替上下。
3. **实时反馈**：系统在计算控制限（UCL/LCL）的同时，会自动扫描历史序列，触发规则的点将以 **红色实心点** 并在外部增加白色描边显示。

---

### 3.4 动态 Canvas 绘图交互 (Canvas Rendering)
**功能描述**：基于自研高性能渲染架构，解决大规模数据量下的卡顿问题。

**交互亮点**：
- **全自动缩放算法**：系统会捕捉全局 `Max(Data, UCL)` 与 `Min(Data, LCL)`，动态计算 Y 轴余量（20% 呼吸空间），确保曲线始终居中。
- **布局自动整理**：点击 **“整理布局”**，系统会自动过滤非数字杂质数据，并重新触发统计引擎刷新，校正视距。

---

### 3.5 成果导出功能 (Export Center)
**功能描述**：提供符合工业存档标准的各类高清格式。

**操作规程**：
1. **白底 PNG**：生成带有白色背景的高清快照，适合插入质量周报。
2. **透明 PNG**：纯净无背景图层，适合专业设计师在分析演示稿中使用。
3. **PDF 文件**：**（已优化）** 系统将精准锁定 Canvas 绘图区域，开启高性能打印通道，生成仅含图表的矢量级 PDF 文档，解决传统网页预览包含杂乱边栏的问题。

---

## 4. 技术特性亮点（申办要点建议）

- **双重统计引擎架构**：支持单点移动极差（I-MR）与均值极差（X-bar-R）的无缝切换计算，内置 SPC 统计常数表（A2, D2, D3, D4 等）。
- **复合判异逻辑并行处理**：实现了多套国际公认判异规则（Nelson & Western Electric）的并行检测算法，侦测效率达 O(n)。
- **物理级 PDF 锁定技术**：通过离屏渲染与 Canvas 快照技术，实现了“所绘即所得”的纯净 PDF 打印导出。
- **工业视距优化系统**：通过 Canvas 实时计算 Y 轴呼吸空间，避免了工业极端偏差数据导致的图表“压扁”或“切断”现象。

---
*版本日期：2026年1月*  
* Smart QC Tools 质量工程开发组 归档*
